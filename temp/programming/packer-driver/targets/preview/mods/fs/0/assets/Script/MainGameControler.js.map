{"version":3,"sources":["file:///Users/backup/SnowyDay/SnowyDay/assets/Script/MainGameControler.ts"],"names":["Component","_decorator","Node","UITransform","Vec3","CCString","ccclass","property","MainGameControler","onLoad","panel","active","bindClickEvent","update","deltaTime","isInGameArea","player","getPosition","gameArea","on","EventType","TOUCH_START","onTouchStart","bind","TOUCH_END","onTouchCancel","TOUCH_MOVE","onTouchMove","TOUCH_CANCEL","event","location","getLocation","touchPos","x","y","touchPoint","setPosition","scheduleOnce","emit","bulletForce","pos","szBg","getComponent","contentSize","width","height"],"mappings":"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","sourcesContent":["import { Component, _decorator, Node, UITransform, EventTouch, Vec3, CCString } from \"cc\";\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('MainGameControler')\nexport class MainGameControler extends Component {\n\n    @property(Node)\n    gameArea: Node;\n\n    @property(Node)\n    player: Node;\n\n    @property(Node)\n    panel: Node;\n\n    @property(Node)\n    touchPoint: Node;\n    \n    @property(CCString)\n    bulletForce: String='500';\n\n    onLoad() {\n        this.panel.active = false;\n        this.bindClickEvent();\n    }\n\n    update(deltaTime: number) {\n        if (!this.isInGameArea(this.player.getPosition())) {\n            this.panel.active = true;\n        }\n    }\n    bindClickEvent() {\n        if (this.gameArea) {\n            this.gameArea.on(Node.EventType.TOUCH_START, this.onTouchStart.bind(this));\n            this.gameArea.on(Node.EventType.TOUCH_END, this.onTouchCancel.bind(this));\n            this.gameArea.on(Node.EventType.TOUCH_MOVE, this.onTouchMove.bind(this));\n            this.gameArea.on(Node.EventType.TOUCH_CANCEL, this.onTouchCancel.bind(this));\n        }\n    }\n    onTouchStart(event: EventTouch) {\n       // console.warn(\"onTouchStart\", event);\n    }\n    onTouchCancel(event: EventTouch) {\n        const location = event.getLocation();\n        const touchPos = new Vec3(location.x - 480, location.y - 320);\n        this.touchPoint.setPosition(touchPos);\n        this.scheduleOnce(() => {\n            this.player.emit('FIRE_TO_POS', this.touchPoint.getPosition(),this.bulletForce);\n        }, 0)\n       // console.warn(\"onTouchCancel\", event);\n    }\n    onTouchMove(event: EventTouch) {\n        const location = event.getLocation();\n        const touchPos = new Vec3(location.x - 480, location.y - 320);\n        this.touchPoint.setPosition(touchPos);\n\n       // console.warn(\"onTouchMove\", event);\n    }\n\n\n    isInGameArea(pos: any) {\n        let szBg = this.gameArea.getComponent(UITransform).contentSize;\n        if (pos.x <= -szBg.width / 2) {\n            return false;\n        }\n        if (pos.x >= szBg.width / 2) {\n            return false;\n        }\n        if (pos.y <= -szBg.height / 2) {\n            return false;\n        }\n        if (pos.y >= szBg.height / 2) {\n            return false;\n        }\n        return true;\n    }\n\n}\n\n\n"]}