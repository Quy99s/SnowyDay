{"version":3,"sources":["file:///Users/backup/SnowyDay/SnowyDay/assets/Script/soundPlayer.ts"],"names":["_decorator","Component","Node","AudioClip","AudioSource","Vec3","ccclass","property","CustomAudioClip","type","visible","SoundPlayer","onLoad","Debug","globalThis","musicAudioSource","node","addComponent","sfxList","forEach","soundObj","sfxMap","soundId","on","playSfx","id","loop","volume","hasOwnProperty","audioSource","sfxNode","parent","setPosition","clip","audioFile","play","console","log","warn"],"mappings":";;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;;;;;;;OACxD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;iCAEjBQ,e,WADZF,OAAO,CAAC,iBAAD,C,UAQHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEN;AAAR,OAAD,C,UAGRI,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEL,WAAR;AAAqBM,QAAAA,OAAO,EAAE;AAA9B,OAAD,C,oCAXb,MACaF,eADb,CAC6B;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAAA,O,kFACxBD,Q;;;;;iBACkB,K;;mFAClBA,Q;;;;;iBACmB,K;;kFACnBA,Q;;;;;iBACS,E;;;;;;;iBAEa,I;;;;;;;iBAGI,I;;;;6BAGlBI,W,YADZL,OAAO,CAAC,aAAD,C,UAEHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAED;AAAR,OAAD,C,uCAFb,MACaG,WADb,SACiCV,SADjC,CAC2C;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,0CAMd,EANc;AAAA;;AAQvCW,QAAAA,MAAM,GAAG;AACLC,UAAAA,KAAK,EAAE;AAAEC,YAAAA,UAAU,CAAC,OAAD,CAAV,GAAsB,IAAtB;AAA4B;;AAAA;AACrC,cAAI,CAAC,KAAKC,gBAAV,EAA4B,KAAKA,gBAAL,GAAwB,KAAKC,IAAL,CAAUC,YAAV,CAAuBb,WAAvB,CAAxB;AAC5B,eAAKc,OAAL,CAAaC,OAAb,CAAsBC,QAAD,IAA+B;AAChD,iBAAKC,MAAL,CAAYD,QAAQ,CAACE,OAArB,IAAgCF,QAAhC;AACH,WAFD;AAGA,eAAKJ,IAAL,CAAUO,EAAV,CAAa,MAAb,EAAqB,KAAKC,OAA1B,EAAmC,IAAnC;AACH;;AACDA,QAAAA,OAAO,CAACC,EAAD,EAAaC,IAAI,GAAG,KAApB,EAA2BC,MAA3B,EAAoE;AACvE,cAAI,KAAKN,MAAL,CAAYO,cAAZ,CAA2BH,EAA3B,CAAJ,EAAoC;AAChC,gBAAIL,QAAyB,GAAG,KAAKC,MAAL,CAAYI,EAAZ,CAAhC;;AACA,gBAAIL,QAAJ,EAAc;AACV,kBAAI,CAACA,QAAQ,CAACS,WAAd,EAA2B;AACvB,sBAAMC,OAAO,GAAG,IAAI5B,IAAJ,CAAS,SAASkB,QAAQ,CAACE,OAA3B,CAAhB;AACAQ,gBAAAA,OAAO,CAACC,MAAR,GAAiB,KAAKf,IAAtB;AACAc,gBAAAA,OAAO,CAACE,WAAR,CAAoB,IAAI3B,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,CAApB;AACAe,gBAAAA,QAAQ,CAACS,WAAT,GAAuBC,OAAO,CAACb,YAAR,CAAqBb,WAArB,CAAvB;AACH;;AACD,kBAAI,CAACgB,QAAQ,CAACS,WAAT,CAAqBI,IAAtB,IAA8Bb,QAAQ,CAACS,WAAT,CAAqBI,IAArB,KAA8Bb,QAAQ,CAACc,SAAzE,EAAoFd,QAAQ,CAACS,WAAT,CAAqBI,IAArB,GAA4Bb,QAAQ,CAACc,SAArC;AACpFd,cAAAA,QAAQ,CAACS,WAAT,CAAqBM,IAArB;AACAf,cAAAA,QAAQ,CAACS,WAAT,CAAqBH,IAArB,GAA4BA,IAA5B;;AACA,kBAAI,OAAOC,MAAP,KAAkB,WAAtB,EAAmC;AAC/BP,gBAAAA,QAAQ,CAACS,WAAT,CAAqBF,MAArB,GAA8BA,MAA9B;AACH;AACJ;;AACDS,YAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+B,aAA/B,EAA8CZ,EAA9C;AACA,mBAAOL,QAAP;AACH,WAlBD,MAkBO;AACHgB,YAAAA,OAAO,CAACE,IAAR,CAAc,mCAAkCb,EAAG,EAAnD;AACA,mBAAO,IAAP;AACH;AACJ;;AAvCsC,O;;;;;iBAE7B,E","sourcesContent":["\nimport { _decorator, Component, Node, AudioClip, AudioSource, Vec3 } from 'cc';\nconst { ccclass, property } = _decorator;\n@ccclass('CustomAudioClip')\nexport class CustomAudioClip {\n    @property\n    isMusic: boolean = false;\n    @property\n    isEffect: boolean = false;\n    @property\n    soundId = ''\n    @property({ type: AudioClip })\n    audioFile: AudioClip = null;\n\n    @property({ type: AudioSource, visible: false })\n    audioSource: AudioSource = null;\n}\n@ccclass('SoundPlayer')\nexport class SoundPlayer extends Component {\n    @property({ type: CustomAudioClip })\n    sfxList = [];\n    musicAudioSource: any;\n    isEnableBGM: any;\n    currentMusic: any;\n    private sfxMap: object = {};\n\n    onLoad() {\n        Debug: { globalThis['sound'] = this };\n        if (!this.musicAudioSource) this.musicAudioSource = this.node.addComponent(AudioSource);\n        this.sfxList.forEach((soundObj: CustomAudioClip) => {\n            this.sfxMap[soundObj.soundId] = soundObj;\n        });\n        this.node.on('PLAY', this.playSfx, this);\n    }\n    playSfx(id: string, loop = false, volume?: number): CustomAudioClip | null {\n        if (this.sfxMap.hasOwnProperty(id)) {\n            let soundObj: CustomAudioClip = this.sfxMap[id];\n            if (soundObj) {\n                if (!soundObj.audioSource) {\n                    const sfxNode = new Node(\"SFX_\" + soundObj.soundId);\n                    sfxNode.parent = this.node;\n                    sfxNode.setPosition(new Vec3(0, 0, 0));\n                    soundObj.audioSource = sfxNode.addComponent(AudioSource);\n                }\n                if (!soundObj.audioSource.clip || soundObj.audioSource.clip !== soundObj.audioFile) soundObj.audioSource.clip = soundObj.audioFile;\n                soundObj.audioSource.play();\n                soundObj.audioSource.loop = loop;\n                if (typeof volume !== \"undefined\") {\n                    soundObj.audioSource.volume = volume;\n                }\n            }\n            console.log(\"%cSOUND playSfx\", \"color: blue\", id);\n            return soundObj;\n        } else {\n            console.warn(`SOUND playSfx, do not have sfx: ${id}`);\n            return null;\n        }\n    }\n}\n\n\n\n"]}